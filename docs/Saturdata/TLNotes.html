<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="This instructor guide accompanies the lecture slides for the Tree Equity Lesson. It includes teaching notes, key concepts, and reminders to support effective instruction. A downloadable pdf of this pages’ contents can be found in the top right corner of the page.">

<title>DS4HS - Tree Equity Instructor Guide</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../Saturdata/custom_theme.css">
<link rel="stylesheet" href="Saturdata/custom_theme.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../Saturdata/DS4HS.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">DS4HS</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-curriculum" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Curriculum</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-curriculum">    
        <li>
    <a class="dropdown-item" href="../Saturdata/TreeLesson.html" rel="" target="">
 <span class="dropdown-text">Tree Equity Lesson</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Saturdata/PublicTransportLesson.html" rel="" target="">
 <span class="dropdown-text">Public Transportation Lesson</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-instructor-materials" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Instructor Materials</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-instructor-materials">    
        <li>
    <a class="dropdown-item" href="../Saturdata/TLNotes.html" rel="" target="">
 <span class="dropdown-text">Tree Equity Guide</span></a>
  </li>  
    </ul>
  </li>
  <li class="dropdown-header">
 <span class="menu-text">Contact</span></li>
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#what-is-data-science-and-why-urban-planning" id="toc-what-is-data-science-and-why-urban-planning" class="nav-link active" data-scroll-target="#what-is-data-science-and-why-urban-planning"><span class="header-section-number">1</span> What is Data Science and Why Urban Planning</a></li>
  <li><a href="#tree-coverage-as-a-social-issue" id="toc-tree-coverage-as-a-social-issue" class="nav-link" data-scroll-target="#tree-coverage-as-a-social-issue"><span class="header-section-number">2</span> Tree Coverage as a Social Issue</a></li>
  <li><a href="#understanding-the-tree-equity-score" id="toc-understanding-the-tree-equity-score" class="nav-link" data-scroll-target="#understanding-the-tree-equity-score"><span class="header-section-number">3</span> Understanding the Tree Equity Score</a></li>
  <li><a href="#foundational-learning" id="toc-foundational-learning" class="nav-link" data-scroll-target="#foundational-learning"><span class="header-section-number">4</span> Foundational Learning</a></li>
  <li><a href="#mathlink-cubes" id="toc-mathlink-cubes" class="nav-link" data-scroll-target="#mathlink-cubes"><span class="header-section-number">5</span> Mathlink Cubes</a></li>
  <li><a href="#teaching-tidyverse-and-ggplot" id="toc-teaching-tidyverse-and-ggplot" class="nav-link" data-scroll-target="#teaching-tidyverse-and-ggplot"><span class="header-section-number">6</span> Teaching tidyverse and ggplot</a>
  <ul class="collapse">
  <li><a href="#core-goals" id="toc-core-goals" class="nav-link" data-scroll-target="#core-goals"><span class="header-section-number">6.1</span> Core Goals</a></li>
  <li><a href="#pedagogical-tips-and-emphases" id="toc-pedagogical-tips-and-emphases" class="nav-link" data-scroll-target="#pedagogical-tips-and-emphases"><span class="header-section-number">6.2</span> Pedagogical Tips and Emphases</a></li>
  </ul></li>
  <li><a href="#student-exploration-final-project" id="toc-student-exploration-final-project" class="nav-link" data-scroll-target="#student-exploration-final-project"><span class="header-section-number">7</span> Student Exploration + Final Project</a>
  <ul class="collapse">
  <li><a href="#group-work-guidance" id="toc-group-work-guidance" class="nav-link" data-scroll-target="#group-work-guidance"><span class="header-section-number">7.1</span> Group Work Guidance</a></li>
  <li><a href="#managing-student-presentations" id="toc-managing-student-presentations" class="nav-link" data-scroll-target="#managing-student-presentations"><span class="header-section-number">7.2</span> Managing Student Presentations</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="TLNotes.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Tree Equity Instructor Guide</h1>
</div>

<div>
  <div class="description">
    This instructor guide accompanies the lecture slides for the Tree Equity Lesson. It includes teaching notes, key concepts, and reminders to support effective instruction. A downloadable pdf of this pages’ contents can be found in the top right corner of the page.
  </div>
</div>


<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p><a href="TreeLesson_WS.pdff" download="" style="padding:10px 15px; background:#007ACC; color:white; text-decoration:none; border-radius:5px;">Download PDF Worksheet</a></p>
<section id="what-is-data-science-and-why-urban-planning" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="what-is-data-science-and-why-urban-planning"><span class="header-section-number">1</span> What is Data Science and Why Urban Planning</h2>
<p><img src="DSCycle.png" class="img-fluid"></p>
<ul>
<li><strong>Key Idea:</strong> Data science is about extracting insight from data to inform action.</li>
<li><strong>Focus</strong> on applications of data science that connect to students interests</li>
<li>Ask students to add their own example of data science they’ve seen and why they suspect it to be data science.</li>
</ul>
<p>Emphasis on Data science and Urban Planning as a cycle that is repetitive. There is always new data being collected and new solutions to be found. This opens up possibilities for limitless data exploration within the field which makes it an amazing introductory example of data science for beginner students.</p>
</section>
<section id="tree-coverage-as-a-social-issue" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="tree-coverage-as-a-social-issue"><span class="header-section-number">2</span> Tree Coverage as a Social Issue</h2>
<ul>
<li><strong>Remember</strong> This concept might be difficult for students to grasp. “How does the amount of trees in my neighborhood affect me?”</li>
<li><strong>Ask</strong> Students, “What does a tree do? What is its purpose” Answers might be “Provides Shade” or “Creates Oxygen” These are already good markers to highlight disparity but informing students of trees other functions and how their presence in a community or the lack thereof can make a large difference in the well-being of its members will help make their studies feel relevant and impactful.</li>
</ul>
</section>
<section id="understanding-the-tree-equity-score" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="understanding-the-tree-equity-score"><span class="header-section-number">3</span> Understanding the Tree Equity Score</h2>
<p><a href="https://www.treeequityscore.org/methodology">Here</a> you can find the methodology behind American Forests Tree Equity Research.</p>
<ul>
<li>The Tree Equity Score represents the <strong>Need</strong> for tree planting in an area. Need or Priority in a neighborhood is calculated by a number of factors that may highlight the potential for the area to be disproportionately affected by extreme heat, pollution and other environmental hazards which could be reduced with the benefits of trees.</li>
</ul>
<p><img src="TESCalc.png" class="img-fluid"></p>
</section>
<section id="foundational-learning" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="foundational-learning"><span class="header-section-number">4</span> Foundational Learning</h2>
<p>DS4HS places a priority on shifting the narrative on data scienc and its accessibility. One of the main goals of this curriculum is to make content as tangible as possible for those with experience in data or statistical analysis. This section introduces key concepts in data science and we want to make sure these concepts are grasped as thoroughly as possible.</p>
<ul>
<li><p><strong>Observation vs.&nbsp;Observational Unit:</strong> Be explicit—each row is one observation, and the observational unit is the “thing” each row represents (e.g., a tree, a bus stop, a city block).In this example the “GEOID” represents one city block group</p></li>
<li><p><strong>Ask:</strong> “What is one row describing?” Have students answer in plain language.</p></li>
<li><p>Variable Types: Clarify the difference between categorical and numerical variables. Use color/highlight in your slides or board to mark a few examples from the dataset. Students often confuse column headers for variable values. Reinforce that variables are columns, values are entries in rows.</p></li>
<li><p>If possible, have students follow along in R to observe the data set. This can help them get used to the variable names and what a typical value looks like for a given variable.</p></li>
</ul>
</section>
<section id="mathlink-cubes" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="mathlink-cubes"><span class="header-section-number">5</span> Mathlink Cubes</h2>
<p>In every lesson, there is some for of interactive portion to help students grasp the task of data wrangling through a physical simulation of the practice.</p>
<p>This example comes from an article in the Journal of Statistics and Data Science Learning <span class="citation" data-cites="mcgowan2025">(<a href="#ref-mcgowan2025" role="doc-biblioref">McGowan 2025</a>)</span>. <a href="https://www.tandfonline.com/doi/citedby/10.1080/26939169.2025.2485234?scroll=top&amp;needAccess=true">Using Mathlink Cubes to Introduce Data Wrangling</a><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> helps to facilitate a tangible understanding of datasets and data manipulation.</p>
<p>This example can also be replicated with paper strips and squares (though the creation of these materials may be tedious.)</p>
<ul>
<li>Hand out Mathlink Cubes to students in the form of “a dataset” meaning cubes are arranged in columns by color. Dependending on the size of your data set(amount of rows), students will need that many blocks of a unique colored block for the mutate example.</li>
</ul>
</section>
<section id="teaching-tidyverse-and-ggplot" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="teaching-tidyverse-and-ggplot"><span class="header-section-number">6</span> Teaching tidyverse and ggplot</h2>
<section id="core-goals" class="level3" data-number="6.1">
<h3 data-number="6.1" class="anchored" data-anchor-id="core-goals"><span class="header-section-number">6.1</span> Core Goals</h3>
<ul>
<li><p>Students experience transforming a dataset using tidyverse data verbs</p></li>
<li><p>They start asking questions of the data: Who’s impacted? Where? What relationships exist?</p></li>
<li><p>Students see visualization as a tool for insight, not just graphics.</p></li>
</ul>
</section>
<section id="pedagogical-tips-and-emphases" class="level3" data-number="6.2">
<h3 data-number="6.2" class="anchored" data-anchor-id="pedagogical-tips-and-emphases"><span class="header-section-number">6.2</span> Pedagogical Tips and Emphases</h3>
<p><strong>1. Emphasize the “verbs” as actions</strong></p>
<ul>
<li><p>Anchor each function to a mental model:</p>
<ul>
<li><p><code>filter()</code> = “cut out <strong>rows</strong> you don’t need”</p></li>
<li><p><code>select()</code> = “keep only the <strong>columns</strong> you care about”</p></li>
<li><p><code>mutate()</code> = “make new columns using calucaltions with exsisting ones”</p></li>
<li><p><code>groupby()</code> = “Sort data into baskets by value”</p></li>
<li><p><code>summarize()</code> = “Pull out the big-picture”</p></li>
</ul></li>
</ul>
<p><strong>2. Highlight data types when visualizing</strong></p>
<ul>
<li><p>Categorical → bar/column</p></li>
<li><p>Continuous → histogram, scatter</p></li>
<li><p>Time-based → line plot</p></li>
<li><p>Encourage asking: <em>“What kind of variable is this? What would help me see patterns?”</em></p></li>
</ul>
<p><strong>3. Don’t skip reading outputs</strong></p>
<ul>
<li><p>Stop after each code chunk and ask: <em>“What changed? What does this output tell us?”</em></p></li>
<li><p>It’s easy for students to focus on syntax and miss what the data is really saying.</p></li>
</ul>
<p><strong>4. Ask real-world connection questions</strong></p>
<ul>
<li><p><em>“What trend do you notice?”, “What might explain that relationship?”, “What other variable might influence both?”</em></p></li>
<li><p>Encourage students to answer these questions in <strong>normal</strong> and <strong>confortable</strong> language rather than expecting a more refined “data-sciency” answer. This will help bridge the gap between their common sense and trained data analysis</p></li>
</ul>
</section>
</section>
<section id="student-exploration-final-project" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="student-exploration-final-project"><span class="header-section-number">7</span> Student Exploration + Final Project</h2>
<p>This capstone activity gives students the chance to apply everything they’ve learned from the lesson. It should feel open-ended and empowering, encouraging curiosity and creative problem-solving.</p>
<p>This is also the moment where data becomes personal and meaningful: students choose their question, their variables, and their visualization. The instructor’s role shifts from direct teaching to coaching, guiding students to sharpen questions, troubleshoot code, and draw clear, grounded conclusions.</p>
<section id="group-work-guidance" class="level3" data-number="7.1">
<h3 data-number="7.1" class="anchored" data-anchor-id="group-work-guidance"><span class="header-section-number">7.1</span> Group Work Guidance</h3>
<p>Students should work in groups of 2–4, ideally with access to a shared device</p>
<p><strong>Encourage them to:</strong></p>
<ul>
<li><p>Settle on a single state or comparison they find interesting.</p></li>
<li><p>Write out a clear, answerable question (this may take several revisions).</p></li>
</ul>
<p><strong>Students will use R to generate at least one graph and one statistical summary.</strong></p>
<p>Instructors or mentors should:</p>
<ul>
<li><p>Circulate and offer help with debugging.</p></li>
<li><p>Ask clarifying questions to refine vague research questions.</p></li>
<li><p><em>“What are you trying to compare? What variable would show that?”</em></p></li>
</ul>
</section>
<section id="managing-student-presentations" class="level3" data-number="7.2">
<h3 data-number="7.2" class="anchored" data-anchor-id="managing-student-presentations"><span class="header-section-number">7.2</span> Managing Student Presentations</h3>
<p>Each group should give a short (~3–4 min) presentation of: - Their question - What data they used - Their plot(s) and the trends they suggest - A brief interpretation: <em>“What does this mean?”</em> and <em>“Why does it matter?”</em></p>
<p><strong>While students present:</strong></p>
<ul>
<li><p>Highlight clarity of visualizations, originality of questions, or insightful interpretations.</p></li>
<li><p>Celebrate one strong point from each group to model good data science communication:</p></li>
</ul>
<p>“What I loved about this presentation was how clear the graph labels were — it helped us understand the pattern immediately.”</p>



</section>
</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-mcgowan2025" class="csl-entry" role="listitem">
McGowan, Lucy D’Agostino. 2025. <span>“Using Mathlink Cubes to Introduce Data Wrangling with Examples in r.”</span> <em>Journal of Statistics and Data Science Education</em> 0 (0): 1–10. <a href="https://doi.org/10.1080/26939169.2025.2485234">https://doi.org/10.1080/26939169.2025.2485234</a>.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>D’Agostino McGowan, L. (2025). Using Mathlink Cubes to Introduce Data Wrangling with Examples in R. Journal of Statistics and Data Science Education, 1–10. https://doi.org/10.1080/26939169.2025.2485234<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>